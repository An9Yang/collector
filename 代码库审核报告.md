# ğŸ” ä»£ç åº“å…¨é¢å®¡æ ¸æŠ¥å‘Š

**é¡¹ç›®**: ClipNote Collector  
**å®¡æ ¸æ—¥æœŸ**: 2024å¹´  
**å®¡æ ¸èŒƒå›´**: å®Œæ•´ä»£ç åº“ç»“æ„ã€æ¶æ„è®¾è®¡ã€æ‰©å±•æ€§ã€æ€§èƒ½å’Œå®‰å…¨æ€§

---

## ğŸ“Š å®¡æ ¸æ€»ç»“

### âœ… **å·²ä¿®å¤çš„ç´§æ€¥é—®é¢˜**
1. **ç«¯å£å†²çª** - å®ç°åŠ¨æ€ç«¯å£åˆ†é…
2. **é‡å¤æ–‡ä»¶** - åˆ é™¤å†—ä½™çš„AddLinkModal.new.tsx

### âš ï¸ **å‘ç°çš„ä¸»è¦é—®é¢˜**
- ğŸ—ï¸ **æ¶æ„é—®é¢˜**: 5ä¸ª
- ğŸ”„ **å†—ä½™é—®é¢˜**: 4ä¸ª  
- ğŸ“ˆ **æ‰©å±•æ€§é—®é¢˜**: 6ä¸ª
- âš¡ **æ€§èƒ½é—®é¢˜**: 3ä¸ª
- ğŸ”’ **å®‰å…¨é—®é¢˜**: 2ä¸ª

---

## ğŸš¨ **ç´§æ€¥é—®é¢˜ï¼ˆå·²ä¿®å¤ï¼‰**

### 1. âœ… ç«¯å£å†²çªé—®é¢˜
**é—®é¢˜**: scraper-server-unified.cjsç¡¬ç¼–ç ç«¯å£3001ï¼Œå¯åŠ¨æ—¶å†²çª
```bash
Error: listen EADDRINUSE: address already in use :::3001
```

**è§£å†³æ–¹æ¡ˆ**: 
- å®ç°åŠ¨æ€ç«¯å£æ£€æµ‹æœºåˆ¶
- ç«¯å£èŒƒå›´3001-3010è‡ªåŠ¨æŸ¥æ‰¾å¯ç”¨ç«¯å£
- æ·»åŠ ä¼˜é›…çš„é”™è¯¯å¤„ç†

### 2. âœ… é‡å¤æ–‡ä»¶é—®é¢˜
**é—®é¢˜**: å­˜åœ¨AddLinkModal.tsxå’ŒAddLinkModal.new.tsxä¸¤ä¸ªç‰ˆæœ¬
**å½±å“**: ä»£ç ç»´æŠ¤å›°éš¾ï¼Œå®¹æ˜“äº§ç”Ÿä¸ä¸€è‡´
**è§£å†³æ–¹æ¡ˆ**: åˆ é™¤.new.tsxç‰ˆæœ¬ï¼Œä¿ç•™åŠŸèƒ½å®Œæ•´çš„ä¸»ç‰ˆæœ¬

---

## ğŸ—ï¸ **æ¶æ„é—®é¢˜**

### 1. ğŸ”§ å•æ–‡ä»¶è¿‡å¤§é—®é¢˜
**æ–‡ä»¶**: 
- `scraper-server-unified.cjs` (547è¡Œ)
- `src/context/ArticlesContext.tsx` (247è¡Œ)
- `src/services/articleService.ts` (267è¡Œ)

**é—®é¢˜**: è¿åå•ä¸€è´£ä»»åŸåˆ™ï¼Œéš¾ä»¥ç»´æŠ¤
**å»ºè®®**: 
```
scraper-server-unified.cjs â†’ æ‹†åˆ†ä¸ºï¼š
â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ app.js (ä¸»æœåŠ¡å™¨)
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ scraper.js
â”‚   â”‚   â””â”€â”€ images.js
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ puppeteerService.js
â”‚   â”‚   â”œâ”€â”€ httpScraper.js
â”‚   â”‚   â””â”€â”€ imageDownloader.js
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ portManager.js
```

### 2. ğŸ“¦ æ··åˆçš„ä¸šåŠ¡é€»è¾‘
**é—®é¢˜**: ArticlesContextåŒæ—¶å¤„ç†æ•°æ®è·å–ã€çŠ¶æ€ç®¡ç†å’ŒUIé€»è¾‘
**å»ºè®®**: å®ç°æ¸…æ™°çš„åˆ†å±‚æ¶æ„
```typescript
// æ•°æ®å±‚
src/data/
â”œâ”€â”€ repositories/
â”‚   â”œâ”€â”€ articleRepository.ts
â”‚   â””â”€â”€ collectionRepository.ts
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ articleService.ts (çº¯ä¸šåŠ¡é€»è¾‘)
â”‚   â””â”€â”€ collectionService.ts

// çŠ¶æ€ç®¡ç†å±‚  
src/store/
â”œâ”€â”€ slices/
â”‚   â”œâ”€â”€ articlesSlice.ts
â”‚   â””â”€â”€ collectionsSlice.ts
â””â”€â”€ store.ts

// è§†å›¾å±‚
src/hooks/
â”œâ”€â”€ useArticles.ts
â””â”€â”€ useCollections.ts
```

### 3. ğŸ”— ç´§è€¦åˆçš„ç»„ä»¶å…³ç³»
**é—®é¢˜**: App.tsxç›´æ¥ç®¡ç†æ‰€æœ‰çŠ¶æ€ï¼Œç»„ä»¶é—´è€¦åˆåº¦é«˜
**å»ºè®®**: 
- å®ç°çŠ¶æ€ç®¡ç†åº“(Zustand/Redux Toolkit)
- ä½¿ç”¨ç»„åˆæ¨¡å¼è€Œéç»§æ‰¿
- å®ç°ç»„ä»¶é—´é€šä¿¡çš„äº‹ä»¶æ€»çº¿

### 4. ğŸ›¡ï¸ ç¼ºå°‘é”™è¯¯è¾¹ç•Œ
**é—®é¢˜**: æ²¡æœ‰Reacté”™è¯¯è¾¹ç•Œï¼Œç»„ä»¶é”™è¯¯ä¼šå¯¼è‡´æ•´ä¸ªåº”ç”¨å´©æºƒ
**å»ºè®®**: 
```typescript
src/components/ErrorBoundary.tsx
src/hooks/useErrorHandler.ts
```

### 5. ğŸ§ª æµ‹è¯•è¦†ç›–ä¸è¶³
**é—®é¢˜**: åªæœ‰åŸºç¡€çš„è¿æ¥æµ‹è¯•ï¼Œç¼ºå°‘ç»„ä»¶å’Œä¸šåŠ¡é€»è¾‘æµ‹è¯•
**å»ºè®®**: å®ç°å…¨é¢çš„æµ‹è¯•ç­–ç•¥
```
src/__tests__/
â”œâ”€â”€ components/
â”œâ”€â”€ hooks/
â”œâ”€â”€ services/
â”œâ”€â”€ utils/
â””â”€â”€ integration/
```

---

## ğŸ”„ **ä»£ç å†—ä½™é—®é¢˜**

### 1. ğŸ” é‡å¤çš„é”™è¯¯å¤„ç†
**ä½ç½®**: ArticleService, CollectionService, ArticlesContext
**é—®é¢˜**: ç›¸åŒçš„ç½‘ç»œé”™è¯¯å¤„ç†é€»è¾‘é‡å¤å‡ºç°
**å»ºè®®**: 
```typescript
// src/utils/errorHandler.ts
export class ApiErrorHandler {
  static handleSupabaseError(error: any): string {
    if (error instanceof TypeError && error.message.includes('fetch')) {
      return 'Unable to connect to database. Please check your internet connection.';
    }
    return error.message || 'Unknown error occurred';
  }
}
```

### 2. ğŸ“Š é‡å¤çš„æ•°æ®è½¬æ¢é€»è¾‘
**é—®é¢˜**: URLéªŒè¯ã€å†…å®¹æ ¼å¼æ£€æµ‹åœ¨å¤šä¸ªç»„ä»¶ä¸­é‡å¤
**å»ºè®®**: åˆ›å»ºé€šç”¨å·¥å…·å‡½æ•°åº“

### 3. ğŸ¨ é‡å¤çš„æ ·å¼ä»£ç 
**é—®é¢˜**: ç›¸ä¼¼çš„Tailwindç±»ç»„åˆåœ¨å¤šä¸ªç»„ä»¶ä¸­é‡å¤
**å»ºè®®**: 
```typescript
// src/styles/components.ts
export const buttonStyles = {
  primary: "bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md",
  outline: "border border-gray-300 hover:bg-gray-50 text-gray-700 font-medium py-2 px-4 rounded-md"
};
```

### 4. ğŸ”§ é‡å¤çš„é…ç½®é€»è¾‘
**é—®é¢˜**: ç«¯å£ã€URLç­‰é…ç½®åˆ†æ•£åœ¨å¤šä¸ªæ–‡ä»¶ä¸­
**å»ºè®®**: ç»Ÿä¸€é…ç½®ç®¡ç†
```typescript
// src/config/index.ts
export const config = {
  api: {
    scraperPort: process.env.SCRAPER_PORT || 3001,
    scraperPortRange: [3001, 3010]
  },
  supabase: {
    url: process.env.VITE_SUPABASE_URL,
    key: process.env.VITE_SUPABASE_ANON_KEY
  }
};
```

---

## ğŸ“ˆ **æ‰©å±•æ€§é—®é¢˜**

### 1. ğŸ”Œ ç¡¬ç¼–ç çš„æ•°æ®æºç±»å‹
**é—®é¢˜**: Articleæ¥å£çš„sourceå­—æ®µç¡¬ç¼–ç ç‰¹å®šå¹³å°
```typescript
source: 'wechat' | 'linkedin' | 'reddit' | 'twitter' | 'x' | 'github' | 'other';
```
**å»ºè®®**: å®ç°å¯æ‰©å±•çš„æºç±»å‹ç³»ç»Ÿ
```typescript
// src/types/sources.ts
export interface SourceType {
  id: string;
  name: string;
  icon: string;
  urlPatterns: string[];
  scrapeStrategy: 'basic' | 'advanced';
}

export const sourceRegistry = new Map<string, SourceType>();
```

### 2. ğŸ¯ å›ºå®šçš„å†…å®¹æ ¼å¼æ”¯æŒ
**é—®é¢˜**: ContentFormatæšä¸¾é™åˆ¶äº†æ”¯æŒçš„æ ¼å¼ç±»å‹
**å»ºè®®**: å®ç°æ’ä»¶åŒ–çš„æ ¼å¼å¤„ç†å™¨
```typescript
// src/processors/
â”œâ”€â”€ FormatProcessor.ts (æ¥å£)
â”œâ”€â”€ MarkdownProcessor.ts
â”œâ”€â”€ HTMLProcessor.ts
â””â”€â”€ DocxProcessor.ts
```

### 3. ğŸ”„ å•ä¸€çš„æŠ“å–ç­–ç•¥
**é—®é¢˜**: ç½‘é¡µæŠ“å–é€»è¾‘å›ºåŒ–åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­
**å»ºè®®**: å®ç°ç­–ç•¥æ¨¡å¼
```typescript
// src/scrapers/
â”œâ”€â”€ ScraperStrategy.ts (æ¥å£)
â”œâ”€â”€ PuppeteerScraper.ts
â”œâ”€â”€ HTTPScraper.ts
â””â”€â”€ APIBasedScraper.ts
```

### 4. ğŸª ç¼ºå°‘æ’ä»¶ç³»ç»Ÿ
**é—®é¢˜**: æ–°åŠŸèƒ½éœ€è¦ä¿®æ”¹æ ¸å¿ƒä»£ç 
**å»ºè®®**: å®ç°æ’ä»¶æ¶æ„
```typescript
// src/plugins/
â”œâ”€â”€ PluginManager.ts
â”œâ”€â”€ types.ts
â””â”€â”€ examples/
    â”œâ”€â”€ TranslationPlugin.ts
    â””â”€â”€ SummaryPlugin.ts
```

### 5. ğŸ“± ç¼ºå°‘ä¸»é¢˜ç³»ç»Ÿ
**é—®é¢˜**: ä¸»é¢˜åˆ‡æ¢é€»è¾‘ç¡¬ç¼–ç åœ¨App.tsxä¸­
**å»ºè®®**: å®ç°å®Œæ•´çš„ä¸»é¢˜ç³»ç»Ÿ
```typescript
// src/themes/
â”œâ”€â”€ ThemeProvider.tsx
â”œâ”€â”€ themes/
â”‚   â”œâ”€â”€ light.ts
â”‚   â”œâ”€â”€ dark.ts
â”‚   â””â”€â”€ custom.ts
â””â”€â”€ hooks/useTheme.ts
```

### 6. ğŸŒ å›½é™…åŒ–æ”¯æŒç¼ºå¤±
**é—®é¢˜**: æ‰€æœ‰æ–‡æœ¬ç¡¬ç¼–ç ä¸ºä¸­æ–‡
**å»ºè®®**: å®ç°i18næ”¯æŒ
```typescript
// src/i18n/
â”œâ”€â”€ index.ts
â”œâ”€â”€ locales/
â”‚   â”œâ”€â”€ zh-CN.json
â”‚   â”œâ”€â”€ en-US.json
â”‚   â””â”€â”€ ja-JP.json
â””â”€â”€ hooks/useTranslation.ts
```

---

## âš¡ **æ€§èƒ½é—®é¢˜**

### 1. ğŸš€ ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“
**é—®é¢˜**: ArticlesContextå€¼æ²¡æœ‰ä½¿ç”¨useMemoä¼˜åŒ–
**å»ºè®®**: 
```typescript
const contextValue = useMemo(() => ({
  articles,
  currentArticle,
  isLoading,
  // ... other values
}), [articles, currentArticle, isLoading]);
```

### 2. ğŸ’¾ ç¼ºå°‘æ•°æ®ç¼“å­˜
**é—®é¢˜**: æ¯æ¬¡åˆ‡æ¢æ”¶è—å¤¹éƒ½é‡æ–°è¯·æ±‚æ•°æ®
**å»ºè®®**: å®ç°æ™ºèƒ½ç¼“å­˜ç­–ç•¥
```typescript
// src/cache/
â”œâ”€â”€ CacheManager.ts
â”œâ”€â”€ strategies/
â”‚   â”œâ”€â”€ LRUCache.ts
â”‚   â””â”€â”€ TimeBasedCache.ts
â””â”€â”€ types.ts
```

### 3. ğŸ“¦ Bundleå¤§å°ä¼˜åŒ–
**é—®é¢˜**: æœªä½¿ç”¨ä»£ç åˆ†å‰²ï¼Œåˆå§‹åŠ è½½åŒ…è¿‡å¤§
**å»ºè®®**: 
```typescript
// å®ç°è·¯ç”±çº§åˆ«çš„ä»£ç åˆ†å‰²
const ArticleView = lazy(() => import('./components/articles/ArticleView'));
const ChatPanel = lazy(() => import('./components/ChatPanel'));
```

---

## ğŸ”’ **å®‰å…¨é—®é¢˜**

### 1. ğŸ”‘ æ•æ„Ÿä¿¡æ¯æš´éœ²
**é—®é¢˜**: Supabaseå¯†é’¥ç›´æ¥ç¡¬ç¼–ç åœ¨ä»£ç ä¸­
```typescript
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...' // æš´éœ²åœ¨ä»£ç ä¸­
```
**å»ºè®®**: 
- ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†
- å®ç°å¯†é’¥è½®æ¢æœºåˆ¶
- æ·»åŠ å¯†é’¥éªŒè¯

### 2. ğŸ›¡ï¸ XSSé˜²æŠ¤ä¸è¶³
**é—®é¢˜**: DOMPurifyé…ç½®å¯èƒ½ä¸å¤Ÿä¸¥æ ¼
**å»ºè®®**: 
```typescript
const strictPurifyConfig = {
  ALLOWED_TAGS: ['p', 'br', 'h1', 'h2', 'h3', 'strong', 'em'],
  ALLOWED_ATTR: ['href'],
  FORBID_SCRIPT: true,
  FORBID_TAGS: ['script', 'object', 'embed', 'iframe']
};
```

---

## ğŸ› ï¸ **æ¨èçš„ä¼˜åŒ–æ­¥éª¤**

### é˜¶æ®µ1: ç«‹å³ä¿®å¤ï¼ˆ1-2å¤©ï¼‰
1. âœ… ä¿®å¤ç«¯å£å†²çªé—®é¢˜
2. âœ… åˆ é™¤é‡å¤æ–‡ä»¶
3. ğŸ”’ ç§»é™¤ç¡¬ç¼–ç çš„æ•æ„Ÿä¿¡æ¯
4. âš¡ æ·»åŠ åŸºç¡€çš„æ€§èƒ½ä¼˜åŒ–

### é˜¶æ®µ2: æ¶æ„é‡æ„ï¼ˆ1-2å‘¨ï¼‰
1. ğŸ—ï¸ å®ç°åˆ†å±‚æ¶æ„
2. ğŸ§ª æ·»åŠ æµ‹è¯•æ¡†æ¶
3. ğŸ“¦ å®ç°ä»£ç åˆ†å‰²
4. ğŸ”„ æå–å…¬å…±é€»è¾‘

### é˜¶æ®µ3: æ‰©å±•æ€§æå‡ï¼ˆ2-3å‘¨ï¼‰
1. ğŸ”Œ å®ç°æ’ä»¶ç³»ç»Ÿ
2. ğŸ¯ å¯é…ç½®çš„æ ¼å¼å¤„ç†
3. ğŸŒ å›½é™…åŒ–æ”¯æŒ
4. ğŸ“± å®Œæ•´çš„ä¸»é¢˜ç³»ç»Ÿ

### é˜¶æ®µ4: æ€§èƒ½å’Œå®‰å…¨ä¼˜åŒ–ï¼ˆ1å‘¨ï¼‰
1. ğŸ’¾ å®ç°æ™ºèƒ½ç¼“å­˜
2. ğŸ›¡ï¸ åŠ å¼ºå®‰å…¨é˜²æŠ¤
3. âš¡ æ€§èƒ½ç›‘æ§
4. ğŸ“Š æ€§èƒ½åˆ†æå’Œä¼˜åŒ–

---

## ğŸ“‹ **æŠ€æœ¯å€ºåŠ¡ä¼˜å…ˆçº§**

### ğŸ”´ é«˜ä¼˜å…ˆçº§ï¼ˆç«‹å³å¤„ç†ï¼‰
- æ•æ„Ÿä¿¡æ¯å®‰å…¨é—®é¢˜
- ç«¯å£å†²çªé—®é¢˜ï¼ˆå·²ä¿®å¤ï¼‰
- é”™è¯¯è¾¹ç•Œç¼ºå¤±

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ï¼ˆ1-2å‘¨å†…ï¼‰
- å•æ–‡ä»¶è¿‡å¤§é—®é¢˜
- æµ‹è¯•è¦†ç›–ä¸è¶³
- ä»£ç å†—ä½™

### ğŸŸ¢ ä½ä¼˜å…ˆçº§ï¼ˆ1ä¸ªæœˆå†…ï¼‰
- å›½é™…åŒ–æ”¯æŒ
- é«˜çº§ä¸»é¢˜ç³»ç»Ÿ
- æ€§èƒ½ä¼˜åŒ–

---

## ğŸ¯ **æ¨èçš„æŠ€æœ¯æ ˆå‡çº§**

### çŠ¶æ€ç®¡ç†
```bash
npm install zustand  # è½»é‡çº§çŠ¶æ€ç®¡ç†
# æˆ–
npm install @reduxjs/toolkit react-redux
```

### æµ‹è¯•æ¡†æ¶
```bash
npm install -D vitest @testing-library/react @testing-library/jest-dom
npm install -D @testing-library/user-event msw
```

### æ€§èƒ½ç›‘æ§
```bash
npm install web-vitals
npm install -D webpack-bundle-analyzer
```

### å›½é™…åŒ–
```bash
npm install react-i18next i18next
```

---

è¿™ä»½å®¡æ ¸æŠ¥å‘Šä¸ºé¡¹ç›®çš„è¿›ä¸€æ­¥å‘å±•æä¾›äº†æ¸…æ™°çš„è·¯çº¿å›¾ã€‚å»ºè®®æŒ‰ç…§ä¼˜å…ˆçº§é€æ­¥å®æ–½æ”¹è¿›ï¼Œç¡®ä¿é¡¹ç›®çš„é•¿æœŸå¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚ 