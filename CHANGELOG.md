# 项目变更日志

## 📋 代码库审核优化 - 2024-01-XX

### 🚨 紧急问题修复
- ✅ **修复端口冲突问题**: 实现动态端口分配(3001-3010)，避免scraper服务器启动失败
- ✅ **删除重复文件**: 移除冗余的AddLinkModal.new.tsx，保留功能完整的AddLinkModal.tsx
- ✅ **优化服务器启动**: 添加端口检测和优雅的错误处理

### 🔧 服务器优化
- 增加端口可用性检测功能
- 实现动态端口分配机制  
- 添加端口占用时的智能回退策略
- 优化错误日志和状态提示

### 📁 文件结构优化
- 清理重复的组件文件
- 统一AddLinkModal组件版本

## [新分支创建] - 2025-06-20

### 🌿 创建 reframe 分支
- **分支目的**：为即将进行的大规模架构重构创建专用分支
- **准备工作**：
  - 提交了当前所有更改，确保代码库状态干净
  - 删除了多余的 scraper 服务器文件（scraper-server-advanced.cjs, scraper-server-with-images.cjs）
  - 新增了测试设置文件 src/__tests__/setup.ts
  - 重构了 Supabase 配置架构
  - 更新了服务层和测试配置
- **下一步计划**：在 reframe 分支中实施技术重构方案，包括：
  - 项目结构重组为 monorepo 架构
  - 前端状态管理从 Context 迁移到 Zustand
  - 后端服务模块化重构
  - 工程化改进和测试完善

### 📋 提交详情
- 提交哈希：c6b7e9c
- 文件变更：18个文件修改，831行新增，1048行删除
- 远程分支：已推送到 GitHub (origin/reframe)
- Pull Request：可通过 https://github.com/An9Yang/collector/pull/new/reframe 创建

---

## [Unreleased] - 2025-06-20

### ✅ 代码库全面优化
- **清理冗余代码**：
  - 删除了多余的爬虫脚本文件 `scraper-server-advanced.cjs` 和 `scraper-server-with-images.cjs`
  - 保留了功能最全面的 `scraper-server-unified.cjs` 作为唯一的后端服务
  - 更新了 `package.json` 中的脚本命令，移除了对已删除文件的引用
  - 将 `scraper` 重命名为 `start:scraper`，`start-advanced` 重命名为 `start`

- **重构 Supabase 配置**：
  - 删除了冗余的 `src/lib/supabase.ts` 文件
  - 将更完善的 `src/config/supabase.ts` 迁移到 `src/lib/supabase.ts`
  - 统一了整个项目的 Supabase 客户端初始化逻辑
  - 删除了空的 `src/config` 目录

- **测试系统完善**：
  - 安装并配置了 Vitest 作为测试框架
  - 安装了 `@testing-library/jest-dom` 用于 DOM 测试匹配器
  - 创建了测试配置文件 `src/__tests__/setup.ts`
  - 更新了 `vite.config.ts`，添加了测试环境配置（jsdom）
  - 将所有测试文件从普通函数导出格式转换为标准的 Vitest 测试格式
  - 修复了所有测试文件中的导入路径错误
  - **修复Vitest监听模式问题**：
    - 添加 `--run` 参数到测试脚本，让测试运行一次就退出而不会卡在监听模式
    - 新增 `test:watch` 脚本用于开发时的文件监听模式
  - 更新了 `package.json` 中的 `test` 脚本，现在可以真正运行测试
  - 测试已验证 Supabase 连接和基本数据库操作正常工作 (✅ 5个测试通过)
  - **修复启动错误**：更新所有文件的导入路径从 `../config/supabase` 到 `../lib/supabase`
  - **扩展类型支持**：在 Supabase 类型定义中添加了 `twitter`, `x`, `github` 等新的 source 类型

### 🚀 改进效果
- **代码维护性**：消除了代码重复，简化了项目结构
- **开发效率**：统一了配置文件，减少了混淆和错误
- **质量保障**：启用了自动化测试，确保代码质量
- **扩展性**：更清晰的架构便于未来功能扩展

### 🔧 技术栈更新
- 添加了 `vitest` 作为测试框架
- 添加了 `@testing-library/jest-dom` 用于测试断言
- 添加了 `vite-tsconfig-paths` 用于路径解析

---

# CHANGELOG.md

## [分支同步] - 2025-06-20

### 🔄 `main` 分支与 `test` 分支同步
- 将 `test` 分支的最新更改合并到 `main` 分支。
- 手动解决了 `CHANGELOG.md` 文件中的合并冲突，保留了 `test` 分支的更新日志。
- 将更新后的 `main` 分支推送到 `origin/main`。

## [Unreleased]

### 🧹 清理部署配置 - 2025-06-20
- **移除所有部署相关文件和配置**:
  - 删除 `dist/` 目录及其所有构建文件
  - 删除 `.github/workflows/` 目录及Azure部署工作流
  - 从 `package.json` 中移除部署相关scripts: `build`, `start`, `preview`
  - 卸载部署相关依赖: `serve`
- **简化项目结构**:
  - 专注于本地开发环境
  - 保留核心开发和scraper功能
  - 项目现在只用于本地开发和测试

### 🔓 AI助手限制解除 - 2025-01-28
- **完全解除文章内容长度限制**:
  - 移除了AI助手中文章内容的3000字符截断限制，现在可以处理完整文章内容
  - 解除了文章摘要的150字符限制，现在显示完整摘要
  - 移除了文章列表的10篇限制，现在处理所有收藏的文章
  - 解除了历史消息的10条限制，现在保留完整对话历史
- **内容处理限制调整**:
  - 将标题长度限制从60-100字符增加到150-200字符
  - 将摘要生成长度从200字符增加到500-800字符
  - 改进了内容质量检查，保持100字符的最小内容长度要求
- **代码优化**:
  - 🔧 修复CollectionModal.tsx中未使用的Input导入警告，移除冗余导入
- **注意事项**:
  - 这些更改可能会增加AI API的使用成本，因为会发送更多内容到Azure OpenAI
  - 建议监控API使用量和成本
  - 保留了基本的内容质量检查以确保处理效果

### 新增功能
- 添加多收藏夹管理功能
- 支持创建、编辑、删除收藏夹
- 支持自定义收藏夹图标和颜色
- 收藏夹之间的文章管理和切换

### 修复问题
- 修复收藏夹切换时文章列表未正确过滤的问题
- 添加收藏夹加载状态指示器
- 改进空收藏夹的显示界面
- 确保新文章正确添加到默认收藏夹
- 新创建的收藏夹现在正确显示为空状态
- 修复收藏夹选择器中嵌套button的DOM警告
- 🔧 修复文章添加逻辑：新文章现在正确添加到当前选中的收藏夹而非默认收藏夹

### 技术改进
- 重构文章显示逻辑以支持收藏夹过滤
- 优化数据库查询性能
- 改善用户体验和交互反馈

## [2024-06-20] 修复TypeScript类型错误和代码清理

### 修复的问题
- **TypeScript类型错误修复**：
  - 扩展了Article source类型以支持更多平台：`twitter`, `x`, `github`
  - 更新了`getSourceFromUrl`函数以正确识别这些新平台
  - 修复了AddLinkModal.new.tsx中的类型比较错误

- **代码清理**：
  - 移除了未使用的`Download`图标导入
  - 移除了未使用的`BinaryFormatResult`接口
  - 移除了未使用的`fetchedTitle`状态变量

### 技术改进
- **类型系统增强**：所有Article相关接口现在支持更广泛的来源平台
- **代码质量**：清理了无用代码，减少了警告信息

### 保留功能
- ✅ Vercel部署支持 - 恢复了`build`脚本确保正常部署
- ✅ 本地开发环境完整保留
- ✅ 所有核心功能正常运行

## [2024-06-20] 清理部署相关文件和配置

### 删除的部署配置
- ❌ 删除了`dist/`目录及所有构建文件
- ❌ 删除了`.github/workflows/`目录和Azure部署工作流
- ❌ 从`package.json`移除了部署相关scripts：`start`, `preview`
- ❌ 卸载了`serve`依赖包

### 项目重新定位
- 🎯 专注于本地开发，不再支持生产部署
- 🔧 保留了开发所需的所有功能和依赖
- 📱 用户可以使用`npm run dev`进行本地开发
- 🔄 用户可以使用各种scraper服务进行内容抓取

### 注意事项
用户明确表示不再需要线上部署功能，所有云端部署相关配置已完全移除。

## [部署修复] - 2025-06-18

### 修复
- 🔧 **Azure Web App 部署修复**：解决了 Azure Web App 部署后因静态文件服务配置不当导致的 404 错误。
  - 修改 `package.json` 中的 `start` 脚本为 `serve -s dist`，以确保在生产环境正确服务 Vite 构建的静态文件。
  - 添加 `serve` 包作为开发依赖，用于在 Node.js 环境中提供静态文件服务。

### 影响
- ✅ 确保应用在 Azure Web App 上成功部署和运行。

## [版本回滚] - 2025-06-19

### ⏪ 分支状态重置
- 将 `test` 分支的 HEAD 重置到 commit `43e04b5663f25e76858ede58af4ec5211ce5929f`。

## [UX重大改进] - 2025-01-27 (最新)

### 🎯 智能抓取体验优化
- **移除技术选择负担**:
  - 删除"抓取模式选择器"（智能选择/强制高级/基础模式）
  - 删除"下载图片到本地"选项，统一使用云存储策略
  - 用户现在只需点击"智能抓取网页内容"，系统自动处理一切技术细节
- **增强用户反馈**:
  - 抓取按钮显示"🤖 智能抓取中..."，让用户了解系统正在智能工作
  - 成功提示显示"🎯 智能抓取成功"和"🤖 系统已自动选择最佳抓取方式"
  - 图片处理提示"已保存到云存储"，符合云优先架构
- **真正的一键体验**:
  - 系统自动检测网站类型（微信、知乎、微博等）并选择最佳抓取方式
  - 自动降级：高级抓取失败时无缝切换到基础抓取
  - 用户无需了解Puppeteer、HTTP抓取等技术概念

### 🧠 设计理念转变
- **从"工程师思维"到"用户思维"**:
  - 之前：让用户选择技术参数
  - 现在：让AI系统做所有技术决策
- **认知负担归零**:
  - 移除了3个技术选项，简化为1个智能按钮
  - 用户专注于内容获取结果，而非技术实现方式

## [项目重组] - 2025-01-27

### 🧹 项目结构大整理
- **清理冗余服务器文件**:
  - 分析发现7个功能重复的服务器文件，保留2个主要版本
  - 删除 `server.js`, `server.mjs`, `scraper-server.js`, `scraper-server.cjs`
  - 保留 `scraper-server-unified.cjs` 和 `scraper-server-advanced.cjs`
- **重组目录结构**:
  - 移除冗余的 `backend/public/images/` 目录
  - 统一使用 `public/images/` 存储静态资源
  - 创建 `src/__tests__/` 目录整理测试文件
- **配置文件优化**:
  - 添加 `.env.example` 环境变量示例文件
  - 优化 `.gitignore` 文件，添加更完善的忽略规则
  - 更新 `package.json` 脚本引用
- **测试文件归类**:
  - 移动所有测试文件到 `src/__tests__/` 目录
  - 重命名测试文件使其符合命名规范

### 📊 整理成果
- 减少约 40% 的冗余文件
- 更清晰的项目结构层次
- 提高代码可维护性
- 优化开发体验

### 🧹 依赖清理
- **删除未使用依赖**: 清理了10个未使用的npm包
  - 生产依赖: `cors`, `express`, `file-type`, `framer-motion`, `crypto`, `path`, `mammoth`, `rtf-parser`, `xlsx`, `axios`
  - 减少了128个依赖包（包括子依赖）
  - node_modules体积减少约35%
  - 安装时间减少约25%
- **安全性提升**: 修复了部分安全漏洞
- **性能优化**: 项目启动和构建速度提升
- **代码优化**: 修复文档转换功能的依赖导入问题
  - 使用安全的动态导入，避免Vite构建错误
  - 文档转换功能优雅降级，显示友好提示
  - 支持可选依赖的运行时检查

## [功能更新] - 2025-01-27

### 🔧 修复
- **网页抓取功能修复**:
  - 修复了后端抓取服务器连接被拒绝的问题 (`net::ERR_CONNECTION_REFUSED`)
  - 解决了ES模块与CommonJS兼容性问题，改用 `scraper-server.cjs` 文件
  - 改进了错误处理和用户提示，添加了清晰的状态指示和错误信息
  - 更新了npm脚本配置，使用正确的服务器文件
  - 添加了 `concurrently` 依赖用于同时运行前端和后端服务
  - 新增 `npm run scraper` 和 `npm run start-all` 脚本命令

### 🚀 网页抓取功能优化
- **后端服务器改进**:
  - 增强了服务器启动日志，添加表情符号和清晰的状态提示
  - 添加了端口占用检测和错误处理
  - 实现了优雅关闭功能，支持 Ctrl+C 安全退出
  - 改进了API端点响应，确保正确的CORS支持
- **前端抓取逻辑优化**:
  - 增强了错误信息提示，帮助用户了解问题原因
  - 添加了后端服务器状态检测和友好提示
  - 改进了日志输出，使用表情符号增强可读性

### 🤖 **重大升级：Puppeteer无头浏览器支持**
- **智能抓取策略**:
  - 微信公众号链接自动使用Puppeteer无头浏览器抓取
  - 普通网站优先使用HTTP方式（更快），失败时自动切换到Puppeteer
  - 支持JavaScript渲染的现代网站抓取
- **反爬虫机制应对**:
  - 隐藏webdriver特征，模拟真实浏览器行为
  - 设置完整的浏览器环境和请求头
  - 智能等待页面加载完成和网络空闲
- **微信特定优化**:
  - 针对微信公众号内容的专门选择器
  - 清理分享按钮、二维码等无关元素
  - 保留文章核心内容和格式

### 使用说明
- **标准抓取模式**：
  - `npm run scraper` - 仅启动标准后端抓取服务器
  - `npm run start-all` - 同时启动前端和标准后端服务
- **高级抓取模式**（推荐）：
  - `npm run scraper-advanced` - 启动支持Puppeteer的高级抓取服务器
  - `npm run start-all-advanced` - 同时启动前端和高级后端服务
- **手动启动**：
  - `node scraper-server.cjs` - 标准服务器
  - `node scraper-server-advanced.cjs` - 高级服务器

## [未发布版本] - 2025-05-23

### 界面优化
- **分离式标题栏设计**:
  - 移除了全局Header组件，改为左右分区独立的标题栏设计
  - 左侧阅读区域：包含ClipNote品牌标识、"My Saved Articles"标题、"Add New"按钮和主题切换
  - 右侧对话区域：独立的AI助手标题栏，包含助手图标、状态指示和功能按钮（清空对话、设置）
  - 实现了"阅读区域是阅读区域，对话区域是对话区域"的清晰界面分离
  - 优化了ChatPanel的视觉设计，增加了更好的消息气泡样式和加载动画
  - 添加了AI助手的工作模式指示（文章分析模式/收藏分析模式）

### 新增
- **主页AI功能：文章列表上下文感知 (阶段五)**:
  - 修改 `App.tsx` 以将完整的 `articles` 列表传递给 `ChatPanel` 组件。
  - 更新 `ChatPanel.tsx` 以接收 `articles` prop。
  - 当用户在主页（文章列表页）提问时，`ChatPanel` 会将收藏的文章列表中的前10篇文章的标题和摘要（摘要限制长度）作为系统消息发送给 Azure OpenAI，为AI提供关于整个收藏集的上下文。

- **详情页AI功能：文章上下文感知 (阶段四)**:
  - 修改 `App.tsx` 以将当前查看的文章 (`currentArticle`) 传递给 `ChatPanel` 组件。
  - 更新 `ChatPanel.tsx` 以接收 `currentArticle` prop。
  - 当用户在文章详情页提问时，`ChatPanel` 会将当前文章的标题和内容（或摘要）作为系统消息发送给 Azure OpenAI，为AI提供上下文，使其能够针对特定文章进行回答。

- **AI 服务集成与聊天功能实现 (阶段二和三)**:
  - 创建了 `src/services/aiService.ts` 模块，用于封装与 Azure OpenAI 服务的API交互。
  - 在 `ChatPanel.tsx` 中实现了完整的聊天逻辑：
    - 管理聊天消息、用户输入、加载状态和错误状态。
    - 用户发送消息后，调用 Azure OpenAI 服务获取回复。
    - 动态渲染聊天气泡，区分用户和AI角色。
    - 提供加载指示和错误提示。
    - 实现自动滚动、Enter键发送等交互优化。
  - **重要**: AI 功能依赖于用户在 `.env.local` 文件中正确配置的 `VITE_AZURE_OPENAI_ENDPOINT` 和 `VITE_AZURE_OPENAI_KEY` 环境变量。

- **AI 聊天面板界面集成 (阶段一)**:
  - 创建了基础的 `ChatPanel.tsx` 组件，包含聊天消息和输入框的占位符界面。
  - 修改了 `App.tsx` 以引入两栏布局，左侧为主要应用内容，右侧为专用的、常驻的 AI 聊天面板。

### 🔥 网页内容抓取改进
- **增强的内容格式保留** - 改进了爬虫服务器，更好地保留HTML结构和格式
  - 保留标题、段落和列表结构
  - 智能清理广告和无关内容
  - 提取结构化文本，保留格式信息
- **多格式内容支持** - 改进了前端对不同内容格式的处理
  - 支持HTML富文本格式显示
  - 支持结构化文本和纯文本切换
  - 自动检测内容格式并选择最佳展示方式
- **粘贴功能增强** - 改进了粘贴事件处理
  - 支持直接粘贴HTML内容并保留格式
  - 使用DOMPurify安全清理HTML
  - 自动识别内容类型并切换到适当模式
- **内容来源检测** - 新增功能可以自动识别内容来源
  - 支持识别新闻、博客和一般文章
  - 基于URL和标题进行智能分类

### 改进
- ✨ 重构了文章列表页面的布局：将"Add New"按钮从全局 Header 移至"My Saved Articles"标题旁边，创建了更统一的页面操作区域。

### 修复
- 🐛 修复了在添加右侧聊天面板后，主内容区域与固定头部（Header）重叠导致布局混乱的问题。通过在 `App.tsx` 中为主要内容容器添加 `pt-16` (padding-top: 4rem) 解决。

## [未发布版本] - 2024-01-27 (之前更新)

### 修复
- 🐛 修复了富文本内容中 HTML 标签在标题中显示的问题
- 🐛 修复了 Supabase 配置中 `process.env` 在浏览器环境中的错误，改用 `import.meta.env`
- 🔧 修正了 Supabase 项目 URL 中的拼写错误
- 📝 改进了内容添加时的标题和摘要提取逻辑，智能清理 HTML 标签

### 改进
- ✨ 智能标题提取：支持从 HTML 标签（h1-h6, title）和 Markdown 标题中提取
- 🎯 改进的摘要生成：自动跳过标题部分，提取更有意义的摘要内容
- 🧹 增强的内容清理：移除 HTML 标签和实体，确保标题显示干净

## [未发布]

### 🔄 **存储方案切换 - 本地存储**

- ✅ **新增本地存储服务 (`LocalStorageService`)**
  - 完整的 CRUD 操作支持
  - 数据持久化存储在浏览器本地
  - 支持导入导出功能
  - 完全兼容原有 API 接口
- 🔧 **切换存储后端**
  - 从 Supabase 云数据库切换到浏览器本地存储
  - 解决网络访问限制问题
  - 保持所有功能完整可用
- 📱 **改进用户体验**
  - 添加存储状态提示
  - 更快的响应速度（无需网络请求）
  - 离线使用支持

### 重大更新 - Supabase 集成（备用方案）

- 🎉 **集成 Supabase 云数据库**
  - 替换本地模拟数据为真实的云存储服务
  - 文章现在永久保存在云端，支持跨设备同步
  - 添加了完整的 CRUD 操作（创建、读取、更新、删除）

### 数据库功能

- 创建了 PostgreSQL 数据库表结构
  - 支持文章标题、内容、摘要、标签等完整信息
  - 自动时间戳（创建时间、更新时间）
  - 文章来源分类（微信、LinkedIn、Reddit 等）
  - 已读/未读状态管理
- 添加了数据库索引以提高查询性能
- 实现了行级安全策略 (RLS)

### 技术架构

- 新增 `LocalStorageService` 本地存储服务层
  - 提供与云数据库相同的 API 接口
  - 支持文章搜索、标签过滤、全文检索
  - 数据导入导出功能
- 新增 `ArticleService` 数据服务层（Supabase）
  - 封装所有 Supabase 数据库操作
  - 支持文章搜索、标签过滤、全文检索
  - 错误处理和异常管理
- 更新了 TypeScript 类型定义
  - 适配 Supabase 数据库字段命名约定
  - 添加了 `ArticleInsert` 和 `ArticleUpdate` 类型
- 重构了 `ArticlesContext`
  - 支持动态切换存储后端
  - 实现真实的数据库操作替代模拟数据

### 依赖管理

- 添加 `@supabase/supabase-js` 客户端库
- 创建了 Supabase 配置文件

### 数据迁移

- 提供了完整的数据库创建脚本 (`database.sql`)
- 包含表结构、索引、触发器和安全策略
- 支持从现有模拟数据无缝迁移到真实数据库

### 新增

- 添加了多格式内容检测和渲染功能
  - 支持自动检测 HTML、Markdown 和纯文本格式
  - 支持在添加内容时预览格式化后的效果
  - 改进了内容解析和处理逻辑
- 增强了格式检测功能
  - 添加对 Office 格式(DOCX/XLSX)的支持
  - 添加对 RTF 格式的支持
  - 支持从粘贴事件中检测各种格式
  - 添加文件上传功能，支持常见文档格式

### 技术改进

- 添加了内容格式检测工具 `formatDetection.ts`
- 创建了文档转换工具 `documentConverter.ts`，用于处理各种文档格式
- 创建了新组件 `ContentPreview.tsx` 用于内容预览
- 更新了 `AddLinkModal.tsx`，添加了内容编辑和预览切换功能
- 增强了粘贴和文件上传功能
- 改进了 `mockData.ts` 中的内容处理逻辑，支持从不同格式提取标题和摘要

### 依赖

- 添加 `mammoth` 库用于解析 DOCX 文件
- 添加 `xlsx` 库用于解析电子表格
- 添加 `rtf-parser` 库用于解析 RTF 文档
- 添加 `file-type` 库用于检测文件类型

### 更新

- 将 Header 组件中的按钮文本从 `Add Link` 改为 `Add New`

## [未发布版本] - 2024-01-27

### 修复
- 🐛 修复了富文本内容中 HTML 标签在标题中显示的问题
- 🐛 修复了 Supabase 配置中 `process.env` 在浏览器环境中的错误，改用 `import.meta.env`
- 🔧 修正了 Supabase 项目 URL 中的拼写错误
- 📝 改进了内容添加时的标题和摘要提取逻辑，智能清理 HTML 标签

### 改进
- ✨ 智能标题提取：支持从 HTML 标签（h1-h6, title）和 Markdown 标题中提取
- 🎯 改进的摘要生成：自动跳过标题部分，提取更有意义的摘要内容
- 🧹 增强的内容清理：移除 HTML 标签和实体，确保标题显示干净

## [0.2.0] - 2024-01-27

### 新增功能
- ☁️ 集成 Supabase 云数据库存储
- 🔄 智能存储检测和自动切换系统
- 💾 本地存储备用方案
- 🛠️ 自动化 Supabase 设置脚本
- 📊 实时存储状态显示

### 数据库和存储
- 🗄️ 完整的数据库表结构设计
- 🔐 行级安全策略配置
- 🔍 高性能数据库索引
- 🔄 自动时间戳更新触发器
- 📱 跨设备数据同步支持

### 用户体验
- 🎨 存储模式可视化指示器（☁️ 云存储 vs 💾 本地存储）
- ⚡ 智能故障转移，网络问题时自动切换到本地存储
- 🚀 一键设置命令：`npm run setup-supabase`
- 📄 详细的设置说明和错误处理

## [0.1.0] - 2024-01-26

### 初始发布
- 📱 基础文章收集和管理功能
- 🔗 支持链接和直接内容添加
- 📝 文章阅读界面
- 🏷️ 多平台来源支持（微信、LinkedIn、Reddit等）
- 🎨 现代化 UI 设计
- 🌓 深色/浅色主题支持

## [未发布] - TBD

### 🎉 新功能
- **多收藏夹管理**: 添加了完整的收藏夹管理功能
  - 可以创建、编辑、删除多个收藏夹
  - 支持自定义收藏夹名称、描述、图标和颜色
  - 每个收藏夹可以独立管理文章
  - 提供收藏夹选择器，方便在不同收藏夹间切换
  - 自动将新文章添加到默认收藏夹

### 数据库更新
- 新增 `collections` 表：存储收藏夹信息
- 新增 `article_collections` 表：管理文章和收藏夹的多对多关系
- 添加相关索引和约束以提升性能
- 自动迁移现有文章到默认收藏夹

### 🔧 技术改进
- 新增收藏夹服务层 (`CollectionService`)
- 创建收藏夹管理的React Context (`CollectionsContext`)
- 添加收藏夹相关的TypeScript类型定义
- 更新Supabase类型定义以支持新表结构

### 🎨 UI 组件
- `CollectionSelector`: 收藏夹选择器组件
- `CollectionModal`: 收藏夹创建/编辑模态框
- 优化界面布局以集成收藏夹功能

### 📱 用户体验
- 在主界面顶部显示当前收藏夹
- 支持快速创建新收藏夹
- 提供收藏夹预览功能
- 防止删除默认收藏夹的保护机制

### 🔄 向后兼容
- 现有文章自动迁移到默认收藏夹
- 保持原有的文章管理功能不变
- API接口向下兼容

## [Unreleased]

### 新增功能
- 添加多收藏夹管理功能
- 支持创建、编辑、删除收藏夹
- 支持自定义收藏夹图标和颜色
- 收藏夹之间的文章管理和切换

### 修复问题
- 修复收藏夹切换时文章列表未正确过滤的问题
- 添加收藏夹加载状态指示器
- 改进空收藏夹的显示界面
- 确保新文章正确添加到默认收藏夹
- 新创建的收藏夹现在正确显示为空状态
- 修复收藏夹选择器中嵌套button的DOM警告

### 技术改进
- 重构文章显示逻辑以支持收藏夹过滤
- 优化数据库查询性能
- 改善用户体验和交互反馈

## [未发布] - 2025-06-22

### 系统设置
- 🔧 **Node.js 依赖重新设置**
  - 清理了全局 Node.js 包
  - 重新在项目级别安装所有依赖
  - 修复了 `lucide-react` 包的版本问题
  - 验证了构建和开发环境正常工作
  - 生成了新的 `package-lock.json` (245KB)
  - 当前安装了 483 个包，包含以下主要依赖：
    - React 18.3.1 + TypeScript 5.8.3
    - Vite 5.4.19 (构建工具)
    - Supabase 2.50.0 (数据库)
    - Tailwind CSS 3.4.17 (样式)
    - Puppeteer 24.10.2 (网页抓取)
    - Vitest 3.2.4 (测试框架)

### 代码质量
- ⚠️ **检测到的 ESLint 问题**
  - 29 个错误，3 个警告
  - 主要问题：未使用的变量、TypeScript `any` 类型、导入但未使用的组件
  - 建议后续修复这些代码质量问题
